<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>snode.c: snode.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">snode.c
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">snode.c </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md1">What is snode.c</a></li>
<li class="level1"><a href="#autotoc_md2">Feature List (not complete)</a></li>
<li class="level1"><a href="#autotoc_md3">Copyright</a><ul><li class="level2"><a href="#autotoc_md4">Initiator and Main developer</a></li>
<li class="level2"><a href="#autotoc_md5">Contributors (Students)</a><ul><li class="level3"><a href="#autotoc_md6">Json Middleware</a></li>
<li class="level3"><a href="#autotoc_md7">Regular-Expression Route-Mapping</a></li>
<li class="level3"><a href="#autotoc_md8">Runtime Module Loading</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md9">Requirements</a></li>
<li class="level1"><a href="#autotoc_md10">Components</a></li>
<li class="level1"><a href="#autotoc_md11">TODOs</a></li>
<li class="level1"><a href="#autotoc_md12">Example Applications</a><ul><li class="level2"><a href="#autotoc_md13">Very Simple HTTP/S Web-Server for static HTML-Pages</a></li>
<li class="level2"><a href="#autotoc_md14">Receive Data by HTTP-Post Request</a></li>
<li class="level2"><a href="#autotoc_md15">Extract Server and Client Information (host name, IP, port, SSL/TLS information)</a></li>
<li class="level2"><a href="#autotoc_md16">Using Regular Expressions in Routes</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_README_dox"></a></p>
<h1><a class="anchor" id="autotoc_md1"></a>
What is snode.c</h1>
<p>snode.c (Simple NODE in C++) is a lean, highly extendable, high-performance layer-based framework for network applications (servers and clients) in the spirit of node.js written entirely in C++. The development of the framework has started during the summer semester 2020 in the context of the course <b>Network and Distributed Systems</b> of the master's program <a href="https://www.fh-ooe.at/en/hagenberg-campus/studiengaenge/master/interactive-media/"><b>Interactive Media</b></a> at the departement <a href="https://www.fh-ooe.at/en/hagenberg-campus/"><b>Informatics, Communications and Media</b></a> at the <a href="https://www.fh-ooe.at/en/"><b>University of Applied Sciences Upper Austria, Campus Hagenberg</b></a> to give students an insight into the fundamental techniques of network- and web-frameworks. Main focus (but not only) of the framework is "Machine to Machine" (M2M) communication and here especially the field of "Internet of Things" (IoT). Keep in mind, that the framework is still in heavy development, APIs can break from commit to commit. But the highest level API (express) is considered stable.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Feature List (not complete)</h1>
<ul>
<li>Non-blocking, event-driven (asynchronous), single threaded, single tasking, layer based design supporting timer (single-shot, interval) and network communication (TCP/IPv4).</li>
<li>Application protocol independent TCP server and TCP client functionality. Application protocols (HTTP, ...) can be connected easily and modularly.</li>
<li>Application protocol independent bluetooth RFCOMM and L2CAP server and client functionality. Application protocols can be easily and modularly connected.</li>
<li>TLS/SSL encryption for server and client (TCP, RFCOMM).</li>
<li>Support of X.509 certificates. TLS/SSL connections can be protected and authenticated using certificates (TCP, RFCOMM).</li>
<li>Fully implemented HTTP(S) application protocol layer (server and client) to which application logic can be connected easily.</li>
<li>High-Level Web API layer with JSON support similar to the API of node.js/express. (Speedup compared to node.js/express approx. 40)</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
Copyright</h1>
<p>GNU Lesser General Public License</p>
<h2><a class="anchor" id="autotoc_md4"></a>
Initiator and Main developer</h2>
<ul>
<li>Volker Christian (me_AT_vchrist.at, volker.christian_AT_fh-hagenberg.at)</li>
</ul>
<h2><a class="anchor" id="autotoc_md5"></a>
Contributors (Students)</h2>
<h3><a class="anchor" id="autotoc_md6"></a>
Json Middleware</h3>
<ul>
<li>Marlene Mayr</li>
<li>Anna Moser</li>
<li>Matteo Prock</li>
<li>Eric Thalhammer</li>
</ul>
<h3><a class="anchor" id="autotoc_md7"></a>
Regular-Expression Route-Mapping</h3>
<ul>
<li>Joelle Helgert</li>
<li>Julia Gruber</li>
<li>Patrick Brandstätter</li>
<li>Fabian Mohr</li>
</ul>
<h3><a class="anchor" id="autotoc_md8"></a>
Runtime Module Loading</h3>
<h1><a class="anchor" id="autotoc_md9"></a>
Requirements</h1>
<ul>
<li>GCC Version 10: As snode.c uses most recent C++-20 language features</li>
<li>libeasyloggingpp: For logging</li>
<li>openssl: For SSL/TLS support</li>
<li>doxygen: For creating the API-documentation</li>
<li>cmake:</li>
<li>iwyu: To check for correct and complete included headers</li>
<li>libmagic: To recognize the type of data in a file using "magic" numbers</li>
<li>clang-format: To format the sourcecode consistently</li>
<li>nlohmann-json3-dev: For JSON support</li>
<li>librange-v3-dev: For C++20 range support also in clang (as long as the compilers didn't support them natively)</li>
</ul>
<h1><a class="anchor" id="autotoc_md10"></a>
Components</h1>
<ul>
<li>libnet (directory net) low level multiplexed network-layer (server/client) with event-loop supporting legacy- and tls-connections</li>
<li>libhttp (directory http) low level http server and client</li>
<li>libexpress (directory express) high level web-api similar to node.js's express module</li>
<li>example applications (directory apps)</li>
</ul>
<h1><a class="anchor" id="autotoc_md11"></a>
TODOs</h1>
<ul>
<li>Add better error processing in HTTPResponseParser</li>
<li>Extend regex-match in Router (path-to-regex in JS)</li>
<li>Add some more complex example apps (Game, Skill for Alexa, ...)</li>
<li>Add WebSocket support for server and client, legacy and tls</li>
<li>Add support for Template-Engines (similar to express)</li>
<li>Add additional transport protocols (udp, bluetooth, local, ipv6, ...)</li>
<li>Implement other protocols (contexts) than http (e.g. mqtt, ftp would be interresting, telnet, smtp)</li>
<li>Finalize cmake-rules to support install</li>
<li>Add cmake description files</li>
<li>Add "logical" events</li>
<li>Support "promisses"</li>
<li>Add OAUTH2 server/client authentification</li>
<li>Write unit tests</li>
<li>Porting snode.c to MS-Windows</li>
<li>Porting snode.c to macOS</li>
<li>Add onSSLConnect callback</li>
</ul>
<h1><a class="anchor" id="autotoc_md12"></a>
Example Applications</h1>
<h2><a class="anchor" id="autotoc_md13"></a>
Very Simple HTTP/S Web-Server for static HTML-Pages</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;easylogging++.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="legacy_2_web_app_8h.html">legacy/WebApp.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="tls_2_web_app_8h.html">tls/WebApp.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_static_middleware_8h.html">middleware/StaticMiddleware.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CERTF &lt;PATH_TO_SERVER_CERTIFICATE_CHAIN_FILE&gt;</span></div>
<div class="line"><span class="preprocessor">#define KEYF &lt;PATH_TO_SERVER_CERTIFICATE_KEY_FILE&gt;</span></div>
<div class="line"><span class="preprocessor">#define KEYFPASS &lt;PASSWORD_OF_THE_SERVER_CERTIFICATE_KEY_FILE&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SERVERROOT &lt;PATH_TO_ROOT_OF_WEBSITE&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">    <a class="code" href="classexpress_1_1_web_app.html#a0a01439a0cc8dfc86ed14f1094826b7e">express::WebApp::init</a>(argc, argv);</div>
<div class="line">    </div>
<div class="line">    <a class="code" href="classexpress_1_1legacy_1_1_web_app.html">express::legacy::WebApp</a> legacyApp;</div>
<div class="line">    legacyApp.<a class="code" href="classexpress_1_1_router.html#adda0b8e1030d917bacb75b570d2a16a8">use</a>(<a class="code" href="classexpress_1_1middleware_1_1_static_middleware.html">express::middleware::StaticMiddleware</a>(SERVERROOT));</div>
<div class="line">    </div>
<div class="line">    <a class="code" href="classexpress_1_1tls_1_1_web_app.html">express::tls::WebApp</a> tlsApp({{<span class="stringliteral">&quot;certChain&quot;</span>, CERTF}, </div>
<div class="line">                                 {<span class="stringliteral">&quot;keyPEM&quot;</span>, KEYF}, </div>
<div class="line">                                 {<span class="stringliteral">&quot;password&quot;</span>, KEYFPASS}});</div>
<div class="line">    tlsApp.<a class="code" href="classexpress_1_1_router.html#adda0b8e1030d917bacb75b570d2a16a8">use</a>(<a class="code" href="classexpress_1_1middleware_1_1_static_middleware.html">express::middleware::StaticMiddleware</a>(SERVERROOT));</div>
<div class="line">    </div>
<div class="line">    legacyApp.<a class="code" href="classexpress_1_1_web_app_t.html#a282a201813c01eefcb85b3a3c5b74b85">listen</a>(8080, [](<span class="keywordtype">int</span> err) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        <span class="keywordflow">if</span> (err != 0) {</div>
<div class="line">            PLOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;listen on port 8080&quot;</span>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            VLOG(0) &lt;&lt; <span class="stringliteral">&quot;snode.c listening on port 8080 for legacy connections&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line">    </div>
<div class="line">    tlsApp.listen(8088, [](<span class="keywordtype">int</span> err) -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        <span class="keywordflow">if</span> (err != 0) {</div>
<div class="line">            PLOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;listen on port 8088&quot;</span>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            VLOG(0) &lt;&lt; <span class="stringliteral">&quot;snode.c listening on port 8088 for SSL/TLS connections&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="classexpress_1_1_web_app.html#a85d9fab4fae0881f8484e07c58f3157a">express::WebApp::start</a>();</div>
<div class="line">}</div>
<div class="ttc" id="a_static_middleware_8h_html"><div class="ttname"><a href="_static_middleware_8h.html">StaticMiddleware.h</a></div></div>
<div class="ttc" id="aclassexpress_1_1_router_html_adda0b8e1030d917bacb75b570d2a16a8"><div class="ttname"><a href="classexpress_1_1_router.html#adda0b8e1030d917bacb75b570d2a16a8">express::Router::use</a></div><div class="ttdeci">Router &amp; use(const std::string &amp;relativeMountPath, const std::function&lt; void(Request &amp;req, Response &amp;res)&gt; &amp;lambda)</div><div class="ttdef"><b>Definition:</b> <a href="_router_8cpp_source.html#l00340">Router.cpp:340</a></div></div>
<div class="ttc" id="aclassexpress_1_1_web_app_html_a0a01439a0cc8dfc86ed14f1094826b7e"><div class="ttname"><a href="classexpress_1_1_web_app.html#a0a01439a0cc8dfc86ed14f1094826b7e">express::WebApp::init</a></div><div class="ttdeci">static void init(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="_web_app_8cpp_source.html#l00035">WebApp.cpp:35</a></div></div>
<div class="ttc" id="aclassexpress_1_1_web_app_html_a85d9fab4fae0881f8484e07c58f3157a"><div class="ttname"><a href="classexpress_1_1_web_app.html#a85d9fab4fae0881f8484e07c58f3157a">express::WebApp::start</a></div><div class="ttdeci">static int start()</div><div class="ttdef"><b>Definition:</b> <a href="_web_app_8cpp_source.html#l00040">WebApp.cpp:40</a></div></div>
<div class="ttc" id="aclassexpress_1_1_web_app_t_html_a282a201813c01eefcb85b3a3c5b74b85"><div class="ttname"><a href="classexpress_1_1_web_app_t.html#a282a201813c01eefcb85b3a3c5b74b85">express::WebAppT::listen</a></div><div class="ttdeci">void listen(uint16_t port, const std::function&lt; void(int err)&gt; &amp;onError=nullptr) override</div><div class="ttdef"><b>Definition:</b> <a href="_web_app_t_8h_source.html#l00081">WebAppT.h:81</a></div></div>
<div class="ttc" id="aclassexpress_1_1legacy_1_1_web_app_html"><div class="ttname"><a href="classexpress_1_1legacy_1_1_web_app.html">express::legacy::WebApp</a></div><div class="ttdef"><b>Definition:</b> <a href="legacy_2_web_app_8h_source.html#l00031">WebApp.h:31</a></div></div>
<div class="ttc" id="aclassexpress_1_1middleware_1_1_static_middleware_html"><div class="ttname"><a href="classexpress_1_1middleware_1_1_static_middleware.html">express::middleware::StaticMiddleware</a></div><div class="ttdef"><b>Definition:</b> <a href="_static_middleware_8h_source.html#l00034">StaticMiddleware.h:34</a></div></div>
<div class="ttc" id="aclassexpress_1_1tls_1_1_web_app_html"><div class="ttname"><a href="classexpress_1_1tls_1_1_web_app.html">express::tls::WebApp</a></div><div class="ttdef"><b>Definition:</b> <a href="tls_2_web_app_8h_source.html#l00031">WebApp.h:31</a></div></div>
<div class="ttc" id="alegacy_2_web_app_8h_html"><div class="ttname"><a href="legacy_2_web_app_8h.html">WebApp.h</a></div></div>
<div class="ttc" id="atls_2_web_app_8h_html"><div class="ttname"><a href="tls_2_web_app_8h.html">WebApp.h</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md14"></a>
Receive Data by HTTP-Post Request</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;easylogging++.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="legacy_2_web_app_8h.html">legacy/WebApp.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="tls_2_web_app_8h.html">tls/WebApp.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CERTF &lt;PATH_TO_SERVER_CERTIFICATE_CHAIN_FILE&gt;</span></div>
<div class="line"><span class="preprocessor">#define KEYF &lt;PATH_TO_SERVER_CERTIFICATE_KEY_FILE&gt;</span></div>
<div class="line"><span class="preprocessor">#define KEYFPASS &lt;PASSWORD_OF_THE_SERVER_CERTIFICATE_KEY_FILE&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]) {</div>
<div class="line">    <a class="code" href="classexpress_1_1_web_app.html#a0a01439a0cc8dfc86ed14f1094826b7e">express::WebApp::init</a>(argc, argv);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classexpress_1_1legacy_1_1_web_app.html">express::legacy::WebApp</a> legacyApp;</div>
<div class="line">    legacyApp.<a class="code" href="classexpress_1_1_router.html#a24c8585efc32c7f8468187a29f5d07c9">get</a>(<span class="stringliteral">&quot;/&quot;</span>, [] <a class="code" href="_router_8h.html#a8b7131df91fe7a961e2cdadcedb55232">APPLICATION</a>(req, res) {</div>
<div class="line">        res.send(<span class="stringliteral">&quot;&lt;html&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;  &lt;head&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;    &lt;style&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;      main {&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        min-height: 30em;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        padding: 3em;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        background-image: repeating-radial-gradient( circle at 0 0, #fff, #ddd 50px);&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;      }&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;      input[type=\&quot;file\&quot;] {&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        display: block;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        margin: 2em;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        padding: 2em;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        border: 1px dotted;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;      }&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;    &lt;/style&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;  &lt;/head&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;  &lt;body&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;    &lt;h1&gt;Datei-Upload mit input type=\&quot;file\&quot;&lt;/h1&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;    &lt;main&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;      &lt;h2&gt;Schicken Sie uns was Schickes!&lt;/h2&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;      &lt;form method=\&quot;post\&quot; enctype=\&quot;multipart/form-data\&quot;&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        &lt;label&gt; Wählen Sie eine Textdatei (*.txt, *.html usw.) von Ihrem Rechner aus.&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;          &lt;input name=\&quot;datei\&quot; type=\&quot;file\&quot; size=\&quot;50\&quot; accept=\&quot;text/*\&quot;&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        &lt;/label&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;        &lt;button&gt;… und ab geht die Post!&lt;/button&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;      &lt;/form&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;    &lt;/main&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;  &lt;/body&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;&lt;/html&gt;&quot;</span>);</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    legacyApp.<a class="code" href="classexpress_1_1_router.html#a26692866d4b0a240bf4c3fef688452d0">post</a>(<span class="stringliteral">&quot;/&quot;</span>, [] <a class="code" href="_router_8h.html#a8b7131df91fe7a961e2cdadcedb55232">APPLICATION</a>(req, res) {</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Content-Type: &quot;</span> &lt;&lt; req.header(<span class="stringliteral">&quot;Content-Type&quot;</span>);</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Content-Length: &quot;</span> &lt;&lt; req.header(<span class="stringliteral">&quot;Content-Length&quot;</span>);</div>
<div class="line">        <span class="keywordtype">char</span>* body = <span class="keyword">new</span> <span class="keywordtype">char</span>[std::stoul(req.header(<span class="stringliteral">&quot;Content-Length&quot;</span>)) + 1];</div>
<div class="line">        memcpy(body, req.body, std::stoul(req.header(<span class="stringliteral">&quot;Content-Length&quot;</span>)));</div>
<div class="line">        body[std::stoi(req.header(<span class="stringliteral">&quot;Content-Length&quot;</span>))] = 0;</div>
<div class="line"> </div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Body: &quot;</span>;</div>
<div class="line">        VLOG(0) &lt;&lt; body;</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">delete</span>[] body;</div>
<div class="line">        </div>
<div class="line">        res.send(<span class="stringliteral">&quot;&lt;html&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;  &lt;body&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;    &lt;h1&gt;Thank you&lt;/h1&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;  &lt;/body&gt;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;&lt;/html&gt;&quot;</span>);</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classexpress_1_1tls_1_1_web_app.html">express::tls::WebApp</a> tlsWebApp({{<span class="stringliteral">&quot;certChain&quot;</span>, CERTF},</div>
<div class="line">                                    {<span class="stringliteral">&quot;keyPEM&quot;</span>, KEYF},</div>
<div class="line">                                    {<span class="stringliteral">&quot;password&quot;</span>, KEYFPASS}});</div>
<div class="line">    tlsWebApp.<a class="code" href="classexpress_1_1_router.html#adda0b8e1030d917bacb75b570d2a16a8">use</a>(legacyApp);</div>
<div class="line"> </div>
<div class="line">    legacyApp.<a class="code" href="classexpress_1_1_web_app_t.html#a282a201813c01eefcb85b3a3c5b74b85">listen</a>(8080, [](<span class="keywordtype">int</span> err) {</div>
<div class="line">        <span class="keywordflow">if</span> (err != 0) {</div>
<div class="line">            PLOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;listen on port 8080&quot;</span>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            VLOG(0) &lt;&lt; <span class="stringliteral">&quot;snode.c listening on port 8080 for legacy connections&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    tlsWebApp.listen(8088, [](<span class="keywordtype">int</span> err) {</div>
<div class="line">        <span class="keywordflow">if</span> (err != 0) {</div>
<div class="line">            PLOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;listen on port 8088&quot;</span>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            VLOG(0) &lt;&lt; <span class="stringliteral">&quot;snode.c listening on port 8088 for SSL/TLS connections&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="classexpress_1_1_web_app.html#a85d9fab4fae0881f8484e07c58f3157a">express::WebApp::start</a>();</div>
<div class="line">}</div>
<div class="ttc" id="a_router_8h_html_a8b7131df91fe7a961e2cdadcedb55232"><div class="ttname"><a href="_router_8h.html#a8b7131df91fe7a961e2cdadcedb55232">APPLICATION</a></div><div class="ttdeci">#define APPLICATION(req, res)</div><div class="ttdef"><b>Definition:</b> <a href="_router_8h_source.html#l00034">Router.h:34</a></div></div>
<div class="ttc" id="aclassexpress_1_1_router_html_a24c8585efc32c7f8468187a29f5d07c9"><div class="ttname"><a href="classexpress_1_1_router.html#a24c8585efc32c7f8468187a29f5d07c9">express::Router::get</a></div><div class="ttdeci">Router &amp; get(const std::string &amp;relativeMountPath, const std::function&lt; void(Request &amp;req, Response &amp;res)&gt; &amp;lambda)</div><div class="ttdef"><b>Definition:</b> <a href="_router_8cpp_source.html#l00342">Router.cpp:342</a></div></div>
<div class="ttc" id="aclassexpress_1_1_router_html_a26692866d4b0a240bf4c3fef688452d0"><div class="ttname"><a href="classexpress_1_1_router.html#a26692866d4b0a240bf4c3fef688452d0">express::Router::post</a></div><div class="ttdeci">Router &amp; post(const std::string &amp;relativeMountPath, const std::function&lt; void(Request &amp;req, Response &amp;res)&gt; &amp;lambda)</div><div class="ttdef"><b>Definition:</b> <a href="_router_8cpp_source.html#l00344">Router.cpp:344</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md15"></a>
Extract Server and Client Information (host name, IP, port, SSL/TLS information)</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;easylogging++.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;openssl/x509v3.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="legacy_2_web_app_8h.html">legacy/WebApp.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="tls_2_web_app_8h.html">tls/WebApp.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_static_middleware_8h.html">middleware/StaticMiddleware.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CERTF &lt;PATH_TO_SERVER_CERTIFICATE_CHAIN_FILE&gt;</span></div>
<div class="line"><span class="preprocessor">#define KEYF &lt;PATH_TO_SERVER_CERTIFICATE_KEY_FILE&gt;</span></div>
<div class="line"><span class="preprocessor">#define KEYFPASS &lt;PASSWORD_OF_THE_SERVER_CERTIFICATE_KEY_FILE&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SERVERROOT &lt;PATH_TO_ROOT_OF_WEBSITE&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceexpress.html">express</a>;</div>
<div class="line"> </div>
<div class="line">Router getRouter() {</div>
<div class="line">    Router router;</div>
<div class="line"> </div>
<div class="line">    router.use(<a class="code" href="namespaceexpress_1_1middleware.html#a2fb128871e11fe983884f466d01bee94">middleware::StaticMiddleware</a>(SERVERROOT));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> router;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv) {</div>
<div class="line">    <a class="code" href="classexpress_1_1_web_app.html#a0a01439a0cc8dfc86ed14f1094826b7e">WebApp::init</a>(argc, argv);</div>
<div class="line"> </div>
<div class="line">    legacy::WebApp legacyApp(getRouter());</div>
<div class="line"> </div>
<div class="line">    legacyApp.<a class="code" href="classexpress_1_1_web_app_t.html#a282a201813c01eefcb85b3a3c5b74b85">listen</a>(8080, [](<span class="keywordtype">int</span> err) {</div>
<div class="line">        <span class="keywordflow">if</span> (err != 0) {</div>
<div class="line">            PLOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;listen on port 8080&quot;</span>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            VLOG(0) &lt;&lt; <span class="stringliteral">&quot;snode.c listening on port 8080 for legacy connections&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    legacyApp.<a class="code" href="classexpress_1_1_web_app_t.html#a5d7d08f703f92a3edd10b60f453062d5">onConnect</a>([](net::socket::legacy::SocketConnection* socketConnection) {</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;OnConnect:&quot;</span>;</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;\tClient: &quot;</span> + socketConnection-&gt;getRemoteAddress().host()</div>
<div class="line">                          + <span class="stringliteral">&quot;(&quot;</span> + socketConnection-&gt;getRemoteAddress().ip() + <span class="stringliteral">&quot;):&quot;</span></div>
<div class="line">                 + std::to_string(socketConnection-&gt;getRemoteAddress().port());</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;\tServer: &quot;</span> + socketConnection-&gt;getLocalAddress().host()</div>
<div class="line">                          + <span class="stringliteral">&quot;(&quot;</span> + socketConnection-&gt;getLocalAddress().ip() + <span class="stringliteral">&quot;):&quot;</span></div>
<div class="line">                 + std::to_string(socketConnection-&gt;getLocalAddress().port());</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    legacyApp.<a class="code" href="classexpress_1_1_web_app_t.html#adc848f02d1e9d961262676ab0d97f3f1">onDisconnect</a>([](net::socket::legacy::SocketConnection* socketConnection) {</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;OnDisconnect:&quot;</span>;</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;\tClient: &quot;</span> + socketConnection-&gt;getRemoteAddress().host()</div>
<div class="line">                          + <span class="stringliteral">&quot;(&quot;</span> + socketConnection-&gt;getRemoteAddress().ip() + <span class="stringliteral">&quot;):&quot;</span></div>
<div class="line">                 + std::to_string(socketConnection-&gt;getRemoteAddress().port());</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;\tServer: &quot;</span> + socketConnection-&gt;getLocalAddress().host() </div>
<div class="line">                          + <span class="stringliteral">&quot;(&quot;</span> + socketConnection-&gt;getLocalAddress().ip() + <span class="stringliteral">&quot;):&quot;</span></div>
<div class="line">                 + std::to_string(socketConnection-&gt;getLocalAddress().port());</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    tls::WebApp tlsApp(getRouter(), {{<span class="stringliteral">&quot;certChain&quot;</span>, CERTF}, </div>
<div class="line">                                     {<span class="stringliteral">&quot;keyPEM&quot;</span>, KEYF}, </div>
<div class="line">                                     {<span class="stringliteral">&quot;password&quot;</span>, KEYFPASS}});</div>
<div class="line"> </div>
<div class="line">    tlsApp.listen(8088, [](<span class="keywordtype">int</span> err) {</div>
<div class="line">        <span class="keywordflow">if</span> (err != 0) {</div>
<div class="line">            PLOG(FATAL) &lt;&lt; <span class="stringliteral">&quot;listen on port 8088&quot;</span>;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            VLOG(0) &lt;&lt; <span class="stringliteral">&quot;snode.c listening on port 8088 for SSL/TLS connections&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    tlsApp.onConnect([](net::socket::tls::SocketConnection* socketConnection) {</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;OnConnect:&quot;</span>;</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;\tServer: &quot;</span> + socketConnection-&gt;getLocalAddress().host()</div>
<div class="line">                          + <span class="stringliteral">&quot;(&quot;</span> + socketConnection-&gt;getLocalAddress().ip() + <span class="stringliteral">&quot;):&quot;</span></div>
<div class="line">                 + std::to_string(socketConnection-&gt;getLocalAddress().port());</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;\tClient: &quot;</span> + socketConnection-&gt;getRemoteAddress().host()</div>
<div class="line">                          + <span class="stringliteral">&quot;(&quot;</span> + socketConnection-&gt;getRemoteAddress().ip() + <span class="stringliteral">&quot;):&quot;</span></div>
<div class="line">                 + std::to_string(socketConnection-&gt;getRemoteAddress().port());</div>
<div class="line"> </div>
<div class="line">        X509* client_cert = SSL_get_peer_certificate(socketConnection-&gt;getSSL());</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (client_cert != NULL) {</div>
<div class="line">            <span class="keywordtype">int</span> verifyErr = SSL_get_verify_result(socketConnection-&gt;getSSL());</div>
<div class="line"> </div>
<div class="line">            VLOG(0) &lt;&lt; <span class="stringliteral">&quot;\tClient certificate: &quot;</span> + std::string(X509_verify_cert_error_string(verifyErr));</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">char</span>* str = X509_NAME_oneline(X509_get_subject_name(client_cert), 0, 0);</div>
<div class="line">            VLOG(0) &lt;&lt; <span class="stringliteral">&quot;\t   Subject: &quot;</span> + std::string(str);</div>
<div class="line">            OPENSSL_free(str);</div>
<div class="line"> </div>
<div class="line">            str = X509_NAME_oneline(X509_get_issuer_name(client_cert), 0, 0);</div>
<div class="line">            VLOG(0) &lt;&lt; <span class="stringliteral">&quot;\t   Issuer: &quot;</span> + std::string(str);</div>
<div class="line">            OPENSSL_free(str);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// We could do all sorts of certificate verification stuff here before deallocating the certificate.</span></div>
<div class="line"> </div>
<div class="line">            GENERAL_NAMES* subjectAltNames = <span class="keyword">static_cast&lt;</span>GENERAL_NAMES*<span class="keyword">&gt;</span>(X509_get_ext_d2i(client_cert, NID_subject_alt_name, NULL, NULL));</div>
<div class="line"> </div>
<div class="line">            int32_t altNameCount = sk_GENERAL_NAME_num(subjectAltNames);</div>
<div class="line">            VLOG(0) &lt;&lt; <span class="stringliteral">&quot;\t   Subject alternative name count: &quot;</span> &lt;&lt; altNameCount;</div>
<div class="line">            <span class="keywordflow">for</span> (int32_t i = 0; i &lt; altNameCount; ++i) {</div>
<div class="line">                GENERAL_NAME* generalName = sk_GENERAL_NAME_value(subjectAltNames, i);</div>
<div class="line">                <span class="keywordflow">if</span> (generalName-&gt;type == GEN_URI) {</div>
<div class="line">                    std::string subjectAltName = std::string(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span> (ASN1_STRING_get0_data(generalName-&gt;d.uniformResourceIdentifier)), ASN1_STRING_length(generalName-&gt;d.uniformResourceIdentifier));</div>
<div class="line">                    VLOG(0) &lt;&lt; <span class="stringliteral">&quot;\t      SAN (URI): &#39;&quot;</span> + subjectAltName;</div>
<div class="line">                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (generalName-&gt;type == GEN_DNS) {</div>
<div class="line">                    std::string subjectAltName = std::string(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(ASN1_STRING_get0_data(generalName-&gt;d.dNSName)), ASN1_STRING_length(generalName-&gt;d.dNSName));</div>
<div class="line">                    VLOG(0) &lt;&lt; <span class="stringliteral">&quot;\t      SAN (DNS): &#39;&quot;</span> + subjectAltName;</div>
<div class="line">                } <span class="keywordflow">else</span> {</div>
<div class="line">                    VLOG(0) &lt;&lt; <span class="stringliteral">&quot;\t      SAN (Type): &#39;&quot;</span> + std::to_string(generalName-&gt;type);</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">            sk_GENERAL_NAME_pop_free(subjectAltNames, GENERAL_NAME_free);</div>
<div class="line"> </div>
<div class="line">            X509_free(client_cert);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            VLOG(0) &lt;&lt; <span class="stringliteral">&quot;\tClient certificate: no certificate&quot;</span>;</div>
<div class="line">        }</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    tlsApp.onDisconnect([](net::socket::tls::SocketConnection* socketConnection) {</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;OnDisconnect:&quot;</span>;</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;\tServer: &quot;</span> + socketConnection-&gt;getLocalAddress().host()</div>
<div class="line">                          + <span class="stringliteral">&quot;(&quot;</span> + socketConnection-&gt;getLocalAddress().ip() + <span class="stringliteral">&quot;):&quot;</span></div>
<div class="line">                 + std::to_string(socketConnection-&gt;getLocalAddress().port());</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;\tClient: &quot;</span> + socketConnection-&gt;getRemoteAddress().host()</div>
<div class="line">                          + <span class="stringliteral">&quot;(&quot;</span> + socketConnection-&gt;getRemoteAddress().ip() + <span class="stringliteral">&quot;):&quot;</span></div>
<div class="line">                 + std::to_string(socketConnection-&gt;getRemoteAddress().port());</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="classexpress_1_1_web_app.html#a85d9fab4fae0881f8484e07c58f3157a">WebApp::start</a>();</div>
<div class="line">}</div>
<div class="ttc" id="aclassexpress_1_1_web_app_t_html_a5d7d08f703f92a3edd10b60f453062d5"><div class="ttname"><a href="classexpress_1_1_web_app_t.html#a5d7d08f703f92a3edd10b60f453062d5">express::WebAppT::onConnect</a></div><div class="ttdeci">void onConnect(const std::function&lt; void(const SocketAddress &amp;, const SocketAddress &amp;)&gt; &amp;onConnect)</div><div class="ttdef"><b>Definition:</b> <a href="_web_app_t_8h_source.html#l00089">WebAppT.h:89</a></div></div>
<div class="ttc" id="aclassexpress_1_1_web_app_t_html_adc848f02d1e9d961262676ab0d97f3f1"><div class="ttname"><a href="classexpress_1_1_web_app_t.html#adc848f02d1e9d961262676ab0d97f3f1">express::WebAppT::onDisconnect</a></div><div class="ttdeci">void onDisconnect(const std::function&lt; void(SocketConnection *)&gt; &amp;onDisconnect)</div><div class="ttdef"><b>Definition:</b> <a href="_web_app_t_8h_source.html#l00097">WebAppT.h:97</a></div></div>
<div class="ttc" id="anamespaceexpress_1_1middleware_html_a2fb128871e11fe983884f466d01bee94"><div class="ttname"><a href="namespaceexpress_1_1middleware.html#a2fb128871e11fe983884f466d01bee94">express::middleware::StaticMiddleware</a></div><div class="ttdeci">class StaticMiddleware &amp; StaticMiddleware(const std::string &amp;root)</div><div class="ttdef"><b>Definition:</b> <a href="_static_middleware_8cpp_source.html#l00124">StaticMiddleware.cpp:124</a></div></div>
<div class="ttc" id="anamespaceexpress_html"><div class="ttname"><a href="namespaceexpress.html">express</a></div><div class="ttdef"><b>Definition:</b> <a href="legacy_2_web_app_8h_source.html#l00029">WebApp.h:29</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md16"></a>
Using Regular Expressions in Routes</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="legacy_2_web_app_8h.html">legacy/WebApp.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="tls_2_web_app_8h.html">tls/WebApp.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;easylogging++.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceexpress.html">express</a>;</div>
<div class="line"> </div>
<div class="line">Router router() {</div>
<div class="line">    Router router;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// http://localhost:8080/account/123/username</span></div>
<div class="line">    router.get(<span class="stringliteral">&quot;/account/:userId(\\d*)/:username&quot;</span>, [] <a class="code" href="_router_8h.html#a8b7131df91fe7a961e2cdadcedb55232">APPLICATION</a>(req, res) {</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Show account of&quot;</span>;</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;UserId: &quot;</span> &lt;&lt; req.params[<span class="stringliteral">&quot;userId&quot;</span>];</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;UserName: &quot;</span> &lt;&lt; req.params[<span class="stringliteral">&quot;userName&quot;</span>];</div>
<div class="line"> </div>
<div class="line">        std::string response = <span class="stringliteral">&quot;&lt;html&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;  &lt;head&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;    &lt;title&gt;Response from snode.c&lt;/title&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;  &lt;/head&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;  &lt;body&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;    &lt;h1&gt;Regex return&lt;/h1&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;    &lt;ul&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;      &lt;li&gt;UserId: &quot;</span> + req.params[<span class="stringliteral">&quot;userId&quot;</span>] + &lt;/li&gt;<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                               &quot;</span>      &lt;li&gt;UserName: <span class="stringliteral">&quot; + req.params[&quot;</span>userName<span class="stringliteral">&quot;] + &lt;/li&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;    &lt;/ul&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;  &lt;/body&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;&lt;/html&gt;&quot;</span>;</div>
<div class="line">        res.send(response);</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// http://localhost:8080/asdf/d123e/jklm/hallo</span></div>
<div class="line">    router.get(<span class="stringliteral">&quot;/asdf/:regex1(d\\d{3}e)/jklm/:regex2&quot;</span>, [] <a class="code" href="_router_8h.html#a8b7131df91fe7a961e2cdadcedb55232">APPLICATION</a>(req, res) {</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Testing Regex&quot;</span>;</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Regex1: &quot;</span> &lt;&lt; req.params[<span class="stringliteral">&quot;regex1&quot;</span>];</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Regex2: &quot;</span> &lt;&lt; req.params[<span class="stringliteral">&quot;regex2&quot;</span>];</div>
<div class="line"> </div>
<div class="line">        std::string response = <span class="stringliteral">&quot;&lt;html&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;  &lt;head&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;    &lt;title&gt;Response from snode.c&lt;/title&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;  &lt;/head&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;  &lt;body&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;    &lt;h1&gt;Regex return&lt;/h1&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;    &lt;ul&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;      &lt;li&gt;Regex 1: &quot;</span> + req.params[<span class="stringliteral">&quot;regex1&quot;</span>] + &lt;/li&gt;<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">                               &quot;</span>      &lt;li&gt;Regex 2: <span class="stringliteral">&quot; + req.params[&quot;</span>regex2<span class="stringliteral">&quot;] + &lt;/li&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;    &lt;/ul&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;  &lt;/body&gt;&quot;</span></div>
<div class="line">                               <span class="stringliteral">&quot;&lt;/html&gt;&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        res.send(response);</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// http://localhost:8080/search/QueryString</span></div>
<div class="line">    router.get(<span class="stringliteral">&quot;/search/:search&quot;</span>, [] <a class="code" href="_router_8h.html#a8b7131df91fe7a961e2cdadcedb55232">APPLICATION</a>(req, res) {</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Show Search of&quot;</span>;</div>
<div class="line">        VLOG(0) &lt;&lt; <span class="stringliteral">&quot;Search: &quot;</span> + req.params[<span class="stringliteral">&quot;search&quot;</span>];</div>
<div class="line"> </div>
<div class="line">        res.send(req.params[<span class="stringliteral">&quot;search&quot;</span>]);</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    router.use([] <a class="code" href="_router_8h.html#a8b7131df91fe7a961e2cdadcedb55232">APPLICATION</a>(req, res) {</div>
<div class="line">        res.status(404).send(<span class="stringliteral">&quot;Not found: &quot;</span> + req.url);</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> router;</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
